!function(){"use strict";let e={isDevelopement:!1,theme:"system",databaseFile:{},configPath:"",updates:{autoCheck:!0,autoDownload:!1},vueApp:null},n=localStorage.getItem("config");n?e=JSON.parse(n):localStorage.setItem("config",JSON.stringify(e));var s=e;window.SharedWorker||alert("Shared Workers are not supported in your browser\nSome functionalities may be missing."),fetch("/api/login").then((e=>e.text().then((n=>{401===e.status||"LOGGED_IN"!==n?(alert("You are not signed in!\nPlease Sign in"),location.href="/login.html"):200!==e.status&&(alert("Nerwork Error!\nPlease check your internet connection."),location.reload())})))).catch((e=>console.log("CAUGHT_ERROR",e)));const t=new SharedWorker("/app/resources/browser.worker.js",{name:"mainWorker"});t.port.start(),console.log("started shared worker"),t.port.postMessage({command:"config",config:s}),window.ipcrenderer=new class{constructor(e){this.worker=e,this.port=this.worker.port,this.onceListeners={},this.listeners={},this.port.addEventListener("message",(e=>{var n,s;(null===(n=e.data)||void 0===n?void 0:n.channel)?(console.log("IPCRenderer: Recived message ",e.data," from main"),this.listeners[e.data.channel]&&this.listeners[e.data.channel].forEach((n=>{var s;return n(this.ipcrendererevent(),...null===(s=e.data)||void 0===s?void 0:s.args)})),this.onceListeners[e.data.channel]&&(this.onceListeners[e.data.channel].forEach((n=>{var s;return n(this.ipcrendererevent(),...null===(s=e.data)||void 0===s?void 0:s.args)})),this.onceListeners[e.data.channel]=null)):(null===(s=e.data)||void 0===s?void 0:s.toIpcClass)&&(this.id=e.data.id,(this.id=0)&&alert("This tab holds the main process!\nDon't close this."))}))}ipcrendererevent(){return{sender:this,senderId:this.id}}on(e,n){return this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(n),this}once(e,n){return this.onceListeners[e]||(this.onceListeners[e]=[]),this.onceListeners[e].push(n),this}send(e,...n){console.log("Posting message ",e,":",n," to the worker"),this.port.postMessage({channel:e,args:n})}}(t),window.ipcrenderer.on("ipc",((e,n)=>{switch(n.command){case"openExternal":window.open(n.url,"_blank");break;case"openForm":let t=new URLSearchParams({form:n.type,...n.args});window.open("forms.html?"+t.toString(),"_blank","width=600,height=400,");break;case"showMessageBox":let o={response:confirm(n.options.message),checkboxChecked:!1};e.sender.send("ipc-showMessageBox",{command:"showMessageBox",data:o});break;case"updateConfig":s=n.newConfig,localStorage.setItem("config",JSON.stringify(s)),e.sender.send("ipc-updateConfig",{command:"updateConfig"})}var s})),t.onerror=function(e){throw console.error(e.error),console.log(e),e},window.config=s}();
